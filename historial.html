<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Historial - GAM Wash Pro</title>

  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="responsive.css">
  <link rel="stylesheet" href="power.css">
  <link rel="stylesheet" href="historial.css">
</head>

<body>

<div class="header-row">
    <div></div>
    <div class="title-group">
        <h1 class="title">GAM Wash Pro</h1>
        <h2 class="subtitle">Historial de lavadas</h2>
    </div>
</div>

<!-- ğŸ”¥ TARJETAS DE ESTADÃSTICAS -->
<div class="stats-container">

    <div class="stat-card">
        <h3 class="stat-value" id="totalLavadas">3</h3>
        <p class="stat-label">Total de Lavadas</p>
    </div>

    <div class="stat-card">
        <h3 class="stat-value" id="tempProm">35ÂºC</h3>
        <p class="stat-label">Temp. Promedio</p>
    </div>

    <div class="stat-card">
        <h3 class="stat-value" id="durProm">2.1h</h3>
        <p class="stat-label">DuraciÃ³n Promedio</p>
    </div>

</div>

<!-- ğŸ”¥ LISTA DE LAVADOS -->
<div class="wash-list">

    <div class="wash-card">
        <div class="wash-header">
            <h3>AlgodÃ³n</h3>
            <span class="badge">Completo</span>
        </div>

        <div class="wash-info">
            <span class="info-item">ğŸ“… 01/11/2025</span>
            <span class="info-item">â± 2h 30min</span>
            <span class="info-item">ğŸŒ¡ 40ÂºC</span>
        </div>
    </div>

    <div class="wash-card">
        <div class="wash-header">
            <h3>Lavado RÃ¡pido</h3>
            <span class="badge">Completo</span>
        </div>

        <div class="wash-info">
            <span class="info-item">ğŸ“… 03/11/2025</span>
            <span class="info-item">â± 30min</span>
            <span class="info-item">ğŸŒ¡ 30ÂºC</span>
        </div>
    </div>

    <div class="wash-card">
        <div class="wash-header">
            <h3>Delicado</h3>
            <span class="badge">Completo</span>
        </div>

        <div class="wash-info">
            <span class="info-item">ğŸ“… 05/11/2025</span>
            <span class="info-item">â± 1h 15min</span>
            <span class="info-item">ğŸŒ¡ 30ÂºC</span>
        </div>
    </div>

</div>

<!-- ğŸ”¥ MENÃš INFERIOR -->
<div class="bottom-bar">

    <button class="bottom-item" onclick="goToHome()">
        <img src="icons/casa.png" class="icon"><span>Inicio</span>
    </button>

    <button class="bottom-item" onclick="location.href='programas.html'">
        <img src="icons/engranaje.png" class="icon"><span>Programas</span>
    </button>

    <button class="bottom-item active">
        <img src="icons/historico.png" class="icon"><span>Historial</span>
    </button>

</div>

<!-- Asistente de voz -->
<div id="voiceBtn" class="voice-floating-btn">
    <span class="mic-icon">ğŸ¤</span>
</div>

<script>
function goToHome() {
    localStorage.setItem("returnToHome", "1");
    location.href = "index.html";
}
</script>

<script src="voice.js"></script>

<script src="sessionManager.js"></script>
<script>
document.addEventListener("DOMContentLoaded", loadHistory);

function loadHistory() {
    let history = getWashHistory(); // viene del sessionManager.js
    
    const list = document.querySelector(".wash-list");

    // ğŸ”¥ Actualizar contador total de lavadas (3 predeterminadas + nuevas)
    document.getElementById("totalLavadas").textContent = 3 + history.length;


    // SI NO HAY HISTORIAL â†’ dejamos lo predeterminado
    if (!history || history.length === 0) return; 

    // SI SÃ HAY HISTORIAL â†’ limpiamos solo la parte dinÃ¡mica
    list.innerHTML = "";

    // Primero agregamos los 3 predeterminados
    const defaults = [
        {
            program: "AlgodÃ³n",
            date: "2025-11-01",
            duration: "2h 30min",
            temp: "40ÂºC"
        },
        {
            program: "Lavado RÃ¡pido",
            date: "2025-11-03",
            duration: "30min",
            temp: "30ÂºC"
        },
        {
            program: "Delicado",
            date: "2025-11-05",
            duration: "1h 15min",
            temp: "30ÂºC"
        }
    ];

    const combined = [...defaults, ...history];

    combined.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

    combined.forEach(entry => {
        const card = document.createElement("div");
        card.classList.add("wash-card");

        card.innerHTML = `
            <div class="wash-header">
                <h3>${entry.program}</h3>
                <span class="badge">Completo</span>
            </div>
            <div class="wash-info">
                <span class="info-item">ğŸ“… ${entry.date}</span>
                <span class="info-item">â± ${entry.duration}</span>
                <span class="info-item">ğŸŒ¡ ${entry.temp}</span>
            </div>
        `;

        list.appendChild(card);
    });

}
</script>


</body>
</html>

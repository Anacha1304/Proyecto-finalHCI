<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personalizar Ciclo â€“ GAM Wash Pro</title>

  <link rel="stylesheet" href="personalizarPrograma.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="responsive.css">
  <link rel="stylesheet" href="power.css">
  <link rel="stylesheet" href="reposo.css">
  <link rel="stylesheet" href="programas.css">
</head>

<body>
    

<!-- ENCABEZADO -->
<div class="header-row">
    <div></div>
    <div class="title-group">
        <h1 class="title">GAM Wash Pro</h1>
        <h2 class="subtitle" id="programSubtitle">Personaliza tu ciclo</h2>
    </div>
</div>

<div class="programs-container">

    <h2 class="programs-title" id="customTitle"></h2>

    <!-- ğŸ”¥ TEMPERATURA -->
    <div class="custom-card">
        <div class="custom-header">
            <span>ğŸŒ¡ï¸ Temperatura</span>
            <span id="tempValue">30ÂºC</span>
        </div>

        <div class="options-row" id="tempOptions">
            <button class="opt-btn" onclick="setTemp(10)">10Âº</button>
            <button class="opt-btn" onclick="setTemp(20)">20Âº</button>
            <button class="opt-btn active" onclick="setTemp(30)">30Âº</button>
            <button class="opt-btn" onclick="setTemp(40)">40Âº</button>
            <button class="opt-btn" onclick="setTemp(50)">50Âº</button>
        </div>
    </div>

    <!-- ğŸ”¥ CENTRIFUGADO -->
    <div class="custom-card">
        <div class="custom-header">
            <span>ğŸ”„ Velocidad de centrifugado</span>
            <span id="spinValue">1200</span>
        </div>

        <div class="options-row" id="spinOptions">
            <button class="opt-btn" onclick="setSpin(400)">400</button>
            <button class="opt-btn" onclick="setSpin(800)">800</button>
            <button class="opt-btn" onclick="setSpin(1000)">1000</button>
            <button class="opt-btn active" onclick="setSpin(1200)">1200</button>
            <button class="opt-btn" onclick="setSpin(1400)">1400</button>
        </div>
    </div>

    <!-- ğŸ”¥ OPCIONES ADICIONALES -->
    <div class="custom-card">
        <div class="custom-header">
            <span>ğŸ§´ Opciones adicionales</span>
        </div>

        <div class="extra-options">

            <div class="extra-item">
                <p><strong>Shampoo Extra</strong><br>
                <span class="desc">Adicionar shampoo extra al ciclo</span></p>

                <label class="switch">
                    <input type="checkbox" id="shampooToggle" aria-label="Activar shampoo extra">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="extra-item">
                <p><strong>Pre-Lavado</strong><br>
                <span class="desc">Para prendas extremadamente percudidas</span></p>

                <label class="switch">
                    <input type="checkbox" id="prelavadoToggle" aria-label="Activar prelavado">
                    <span class="slider"></span>
                </label>
            </div>

        </div>
    </div>

</div>

<!-- BOTONES -->
<div class="button-row" style="margin-top: 20px;">
    <button class="btn white" onclick="cancelar()">Cancelar</button>
    <button class="btn blue" onclick="guardarCambios()">Guardar</button>
</div>

<script src="sessionManager.js"></script>

<script>
/* -------------------------------------------------------
   ğŸ”¥ CARGAR NOMBRE DEL PROGRAMA DESDE LOCALSTORAGE
------------------------------------------------------- */
const programName = localStorage.getItem("selectedProgram") || "Delicado";

document.getElementById("customTitle").textContent =
    "Programa tu ciclo " + programName + ":";

document.getElementById("programSubtitle").textContent = programName;

/* -------------------------------------------------------
   ğŸ”¥ FUNCIONES PARA TEMPERATURA
------------------------------------------------------- */
function setTemp(val) {
    document.getElementById("tempValue").textContent = val + "ÂºC";

    document.querySelectorAll("#tempOptions .opt-btn")
        .forEach(btn => btn.classList.remove("active"));

    event.target.classList.add("active");
}


/* -------------------------------------------------------
   ğŸ”¥ FUNCIONES PARA CENTRIFUGADO
------------------------------------------------------- */
function setSpin(val) {
    document.getElementById("spinValue").textContent = val;

    document.querySelectorAll("#spinOptions .opt-btn")
        .forEach(btn => btn.classList.remove("active"));

    event.target.classList.add("active");
}


/* -------------------------------------------------------
   ğŸ”¥ GUARDAR EN LOCALSTORAGE
------------------------------------------------------- */
function guardarCambios() {
    const settings = {
        temp: document.getElementById("tempValue").textContent,
        spin: document.getElementById("spinValue").textContent,
        shampoo: document.getElementById("shampooToggle").checked,
        prelavado: document.getElementById("prelavadoToggle").checked
    };

    saveProgramSettings(programName, settings);

    // Mostrar popup bonito âœ¨
    document.getElementById("savePopup").classList.add("show");
}


function closePopup() {
    document.getElementById("savePopup").classList.remove("show");

    // PequeÃ±o delay para smoothness
    setTimeout(() => {
        location.href = "programas.html";
    }, 200);
}


/* -------------------------------------------------------
   ğŸ”¥ CARGAR CONFIGURACIÃ“N GUARDADA (si existe)
------------------------------------------------------- */
const savedSettings = getProgramSettings(programName);

if (savedSettings) {
    // Temperatura
    document.getElementById("tempValue").textContent = savedSettings.temp;

    document.querySelectorAll("#tempOptions .opt-btn").forEach(btn => {
        btn.classList.toggle(
            "active",
            btn.textContent.trim().replace("Âº", "") === savedSettings.temp.replace("ÂºC", "")
        );
    });

    // Spin
    document.getElementById("spinValue").textContent = savedSettings.spin;

    document.querySelectorAll("#spinOptions .opt-btn").forEach(btn => {
        btn.classList.toggle(
            "active",
            btn.textContent.trim() === savedSettings.spin.trim()
        );
    });

    // Shampoo extra
    document.getElementById("shampooToggle").checked = savedSettings.shampoo;

    // Prelavado
    document.getElementById("prelavadoToggle").checked = savedSettings.prelavado;
}


/* -------------------------------------------------------
   ğŸ”¥ CANCELAR â€“ Volver sin guardar
------------------------------------------------------- */
function cancelar() {
    location.href = "programas.html";
}
</script>

<!-- ğŸ”¥ POPUP DE CONFIRMACIÃ“N -->
<div id="savePopup" class="popup-overlay">
    <div class="popup-card">
        <h2 class="popup-title">Â¡ConfiguraciÃ³n guardada!</h2>
        <p class="popup-text">Tu ciclo personalizado ha sido actualizado correctamente.</p>

        <button class="btn blue" onclick="closePopup()">Aceptar</button>
    </div>
</div>


</body>
</html>
